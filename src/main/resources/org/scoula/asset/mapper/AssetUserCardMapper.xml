<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.scoula.asset.mapper.AssetUserCardMapper">
    <resultMap id="CardSummaryMap" type="org.scoula.asset.domain.CardSummaryVO">
        <id property="id" column="id"/>
        <result property="issuerCode" column="issuer_code"/>
        <result property="cardName" column="card_name"/>
        <result property="cardMaskedNumber" column="card_masked_number"
                typeHandler="org.scoula.codef.util.AesEncryptTypeHandler"/>
        <result property="cardType" column="card_type"/>
        <result property="cardImage" column="card_image"/>
    </resultMap>



    <select id="findCardSummariesByUserId" resultMap="CardSummaryMap">
        SELECT id, issuer_code, card_name, card_masked_number, card_type, card_image
        FROM user_card
        WHERE user_id = #{userId}
    </select>

    <select id="isCardOwner" resultType="boolean">
        SELECT COUNT(*) > 0
        FROM user_card
        WHERE id = #{cardId}
          AND user_id = #{userId}
    </select>
</mapper>
